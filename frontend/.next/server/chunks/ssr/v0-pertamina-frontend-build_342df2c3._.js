module.exports=[16411,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"BailoutToCSR",{enumerable:!0,get:function(){return e}});let d=a.r(64999);function e({reason:a,children:b}){throw Object.defineProperty(new d.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},93512,(a,b,c)=>{"use strict";function d(a){return a.split("/").map(a=>encodeURIComponent(a)).join("/")}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"encodeURIPath",{enumerable:!0,get:function(){return d}})},69241,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"PreloadChunks",{enumerable:!0,get:function(){return h}});let d=a.r(23577),e=a.r(21892),f=a.r(56704),g=a.r(93512);function h({moduleIds:a}){let b=f.workAsyncStorage.getStore();if(void 0===b)return null;let c=[];if(b.reactLoadableManifest&&a){let d=b.reactLoadableManifest;for(let b of a){if(!d[b])continue;let a=d[b].files;c.push(...a)}}return 0===c.length?null:(0,d.jsx)(d.Fragment,{children:c.map(a=>{let c=`${b.assetPrefix}/_next/${(0,g.encodeURIPath)(a)}`;return a.endsWith(".css")?(0,d.jsx)("link",{precedence:"dynamic",href:c,rel:"stylesheet",as:"style",nonce:b.nonce},a):((0,e.preload)(c,{as:"script",fetchPriority:"low",nonce:b.nonce}),null)})})}},82680,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return j}});let d=a.r(23577),e=a.r(4132),f=a.r(16411),g=a.r(69241);function h(a){return{default:a&&"default"in a?a.default:a}}let i={loader:()=>Promise.resolve(h(()=>null)),loading:null,ssr:!0},j=function(a){let b={...i,...a},c=(0,e.lazy)(()=>b.loader().then(h)),j=b.loading;function k(a){let h=j?(0,d.jsx)(j,{isLoading:!0,pastDelay:!0,error:null}):null,i=!b.ssr||!!b.loading,k=i?e.Suspense:e.Fragment,l=b.ssr?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.PreloadChunks,{moduleIds:b.modules}),(0,d.jsx)(c,{...a})]}):(0,d.jsx)(f.BailoutToCSR,{reason:"next/dynamic",children:(0,d.jsx)(c,{...a})});return(0,d.jsx)(k,{...i?{fallback:h}:{},children:l})}return k.displayName="LoadableComponent",k}},21570,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return e}});let d=a.r(60205)._(a.r(82680));function e(a,b){let c={};"function"==typeof a&&(c.loader=a);let e={...c,...b};return(0,d.default)({...e,modules:e.loadableGenerated?.modules})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},68367,a=>{"use strict";var b=a.i(23577),c=a.i(4132),d=a.i(21570),e=a.i(24626),f=a.i(2465);let g=(0,d.default)(async()=>{},{loadableGenerated:{modules:[19606]},ssr:!1,loading:()=>(0,b.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-blue-950/30 to-slate-900/30 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500 mb-3"}),(0,b.jsx)("p",{className:"text-white font-semibold",children:"Loading Maps..."})]})})}),h=(0,d.default)(async()=>{},{loadableGenerated:{modules:[19606]},ssr:!1}),i=(0,d.default)(async()=>{},{loadableGenerated:{modules:[19606]},ssr:!1}),j=(0,d.default)(async()=>{},{loadableGenerated:{modules:[19606]},ssr:!1});function k(){let[d,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)(!1),z=(0,c.useRef)(null),A=(0,c.useRef)(null);(0,c.useEffect)(()=>{y(!0),(async()=>{try{let b=await a.A(22646);A.current=b,delete b.Icon.Default.prototype._getIconUrl,b.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"})}catch(a){console.error("Failed to load Leaflet:",a)}})()},[]);let B=(0,c.useCallback)(async()=>{try{w(!0);let a=await f.api.getBuildings();if(console.log("Buildings data received:",a),Array.isArray(a)){let b=a.filter(a=>a.name&&a.latitude&&a.longitude).reduce((a,b)=>{let c=a.find(a=>a.name===b.name);return c?(c.ids=[...c.ids,b.id],b.rooms&&Array.isArray(b.rooms)&&(c.rooms=c.rooms||[],c.rooms=[...c.rooms,...b.rooms])):a.push({...b,ids:[b.id]}),a},[]).map(a=>{if(a.rooms&&Array.isArray(a.rooms)){let b=Array.from(new Map(a.rooms.map(a=>[a.name,a])).values());return{...a,rooms:b}}return a});console.log("Processed buildings:",b),k(b)}else k([])}catch(a){console.error("Failed to fetch buildings:",a),k([])}finally{w(!1)}},[]);(0,c.useEffect)(()=>{if(x){let a=setTimeout(()=>{B()},100);return()=>clearTimeout(a)}},[x]);let C=async a=>{console.log("Building clicked:",a);try{let b=[];if(a.ids&&Array.isArray(a.ids)){let c=a.ids.map(a=>f.api.getRoomsByBuilding(a));b=(await Promise.all(c)).flat()}else{let c=await f.api.getRoomsByBuilding(a.id);b=Array.isArray(c)?c:[]}console.log("All rooms fetched:",b);let c=b.filter(a=>a.name),d=new Map;c.forEach(a=>{if(d.has(a.name)){let b=d.get(a.name);a.cctvs&&Array.isArray(a.cctvs)&&(b.cctvs=b.cctvs||[],b.cctvs=[...b.cctvs,...a.cctvs])}else d.set(a.name,{...a})});let e=Array.from(d.values());console.log("Unique rooms with merged CCTVs:",e);let g={...a,rooms:e};m(g),u(!0)}catch(b){console.error("Failed to fetch rooms for building:",b),m({...a,rooms:[]}),u(!0)}},D=(0,c.useCallback)(async a=>{try{o(a),s(!0);let b=await f.api.getCctvStreamUrl(a.id);q(b)}catch(a){console.error("Failed to fetch stream URL:",a)}},[]);(0,c.useEffect)(()=>{let a=a=>{"Escape"===a.key&&(s(!1),q(null))};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[]);let E=(0,c.useCallback)((a=!0)=>{if(!A.current)return;let b=`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
        <circle cx="12" cy="12" r="10" fill="#3b82f6" stroke="#1d4ed8" stroke-width="2"/>
        <circle cx="12" cy="12" r="4" fill="#ffffff"/>
      </svg>
    `;return new A.current.Icon({iconUrl:`data:image/svg+xml;base64,${btoa(b)}`,iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]})},[]);return x?(0,b.jsxs)("main",{className:"bg-gradient-to-br from-blue-950 via-slate-900 to-blue-950 py-8 min-h-[calc(100vh-140px)] flex flex-col",children:[(0,b.jsx)("div",{className:"pt-4 pb-6 px-4",children:(0,b.jsx)("div",{className:"flex justify-center items-center gap-4",children:(0,b.jsx)("h1",{className:"text-3xl md:text-4xl font-semibold text-white text-center",children:"Maps"})})}),(0,b.jsx)("div",{className:"px-4 pb-6 flex-grow flex justify-center",children:(0,b.jsx)("div",{className:"h-[50vh] sm:h-[60vh] md:h-[70vh] w-full max-w-4xl rounded-2xl overflow-hidden shadow-2xl z-0",children:v?(0,b.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-blue-950/30 to-slate-900/30 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500 mb-3"}),(0,b.jsx)("p",{className:"text-white font-semibold",children:"Loading Maps..."})]})}):(0,b.jsxs)(g,{center:[-6.1751,108.2146],zoom:13,style:{height:"100%",width:"100%"},className:"z-0",ref:z,children:[(0,b.jsx)(h,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),d.filter(a=>a.latitude&&a.longitude).map(a=>(0,b.jsx)(i,{position:[parseFloat(a.latitude),parseFloat(a.longitude)],icon:E(!0),eventHandlers:{click:()=>C(a)},children:(0,b.jsx)(j,{className:"!rounded-xl !border !border-white/30 !shadow-2xl !bg-blue-950/70 !backdrop-blur-md !text-white !p-0 !min-w-[200px]",children:(0,b.jsxs)("div",{className:"p-3",children:[(0,b.jsx)("h3",{className:"font-black text-xl text-black mb-2 drop-shadow-md text-center",children:a.name||"Unnamed Building"}),(0,b.jsx)("button",{onClick:()=>C(a),className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white text-sm font-semibold py-2 px-3 rounded-lg shadow-md transition-all duration-200 transform hover:scale-[1.02]",children:"View Room"})]})})},`building-${a.id}`))]})})}),r&&n&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-blue-950 border border-white/20 rounded-xl w-full max-w-3xl flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 md:p-6 border-b border-white/10",children:[(0,b.jsx)("h2",{className:"text-lg md:text-xl font-semibold text-white flex items-center gap-2",children:(0,b.jsx)("span",{className:"truncate max-w-[150px] sm:max-w-xs md:max-w-md",children:n.name})}),(0,b.jsx)("button",{onClick:()=>s(!1),className:"text-white hover:text-white transition p-1","aria-label":"Close",children:(0,b.jsx)("span",{className:"text-2xl font-light",children:"×"})})]}),(0,b.jsx)("div",{className:"aspect-video bg-black/50 flex items-center justify-center flex-grow live-stream-video-container",children:(0,b.jsxs)("div",{className:"text-center p-4",children:[(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-8 h-8 text-white mx-auto mb-3",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z"})}),(0,b.jsx)("p",{className:"text-white font-semibold",children:"Live stream player"}),(0,b.jsxs)("div",{className:"mt-4 text-xs text-white",children:[(0,b.jsx)("p",{className:"truncate",children:n.ip_address}),(0,b.jsx)("p",{children:n.username})]})]})}),(0,b.jsx)("div",{className:"p-4 border-t border-white/10",children:(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)("button",{onClick:()=>{let a=document.querySelector(".live-stream-video-container");a&&(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen():a.requestFullscreen?a.requestFullscreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen&&a.mozRequestFullScreen())},className:"flex-1 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 text-sm",children:"Full Screen"})})})]})}),t&&l&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-blue-950 border border-white/20 rounded-2xl w-full max-w-6xl max-h-[80vh] flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 md:p-6 border-b border-white/10",children:[(0,b.jsxs)("h2",{className:"text-lg md:text-xl font-semibold text-white",children:["Rooms in ",l.name||"Unnamed Building"]}),(0,b.jsx)("button",{onClick:()=>{u(!1),m(null)},className:"text-white hover:text-white transition p-1","aria-label":"Close",children:(0,b.jsx)(e.X,{className:"w-5 h-5"})})]}),(0,b.jsx)("div",{className:"p-4 md:p-6 overflow-y-auto flex-grow",children:l.rooms&&Array.isArray(l.rooms)?l.rooms.length>0?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:l.rooms.map(a=>(0,b.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4",children:[(0,b.jsx)("h3",{className:"font-bold text-white mb-2",children:a.name||"Unnamed Room"}),(0,b.jsxs)("p",{className:"text-sm text-white mb-3",children:[a.cctvs&&Array.isArray(a.cctvs)?a.cctvs.length:0," CCTV Camera"]}),(0,b.jsx)("div",{className:"space-y-2",children:a.cctvs&&Array.isArray(a.cctvs)&&a.cctvs.length>0?a.cctvs.map(a=>(0,b.jsxs)("button",{onClick:()=>{D(a),u(!1)},className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white text-sm font-semibold py-2 px-3 rounded-lg flex items-center justify-center gap-2 shadow-md transition-all duration-200 transform hover:scale-[1.02]",children:[(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z"})}),(0,b.jsx)("span",{className:"truncate",children:a.name||"Unnamed CCTV"})]},`cctv-${a.id}`)):(0,b.jsxs)("button",{onClick:()=>{D({id:`room-${a.id}-default`,name:`${a.name||"Room"} Camera`,room:a}),u(!1)},className:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white text-sm font-semibold py-2 px-3 rounded-lg flex items-center justify-center gap-2 shadow-md transition-all duration-200 transform hover:scale-[1.02]",children:[(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z"})}),(0,b.jsx)("span",{children:"View Camera"})]})})]},`room-${a.id}`))}):(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("p",{className:"text-white",children:"No rooms found for this building"})}):(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("p",{className:"text-white",children:"Error loading room data"})})})]})})]}):(0,b.jsxs)("main",{className:"bg-gradient-to-br from-blue-950 via-slate-900 to-blue-950 py-8 min-h-[calc(100vh-140px)] flex flex-col",children:[(0,b.jsx)("div",{className:"pt-4 pb-6 px-4",children:(0,b.jsx)("div",{className:"flex justify-center items-center gap-4",children:(0,b.jsx)("h1",{className:"text-3xl md:text-4xl font-semibold text-white text-center",children:"Maps"})})}),(0,b.jsx)("div",{className:"px-4 pb-6 flex-grow flex justify-center",children:(0,b.jsx)("div",{className:"h-[50vh] sm:h-[60vh] md:h-[70vh] w-full max-w-4xl rounded-2xl overflow-hidden shadow-2xl z-0",children:(0,b.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-blue-950/30 to-slate-900/30 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500 mb-3"}),(0,b.jsx)("p",{className:"text-white font-semibold",children:"Loading Maps..."})]})})})})]})}a.s(["default",()=>k])}];

//# sourceMappingURL=v0-pertamina-frontend-build_342df2c3._.js.map